import { Tooltip, Typography, Tag, Button } from "antd";
import Image from "next/image";
import { formatType } from "@/utils/common-utils";

export const aggregatedVulnerabilityColumns = [
    {
        title: 'Vulnerability Type',
        dataIndex: "cwe_title",
        key: "aggregated_cwe_title",
        // width:'150px',
        render: (value: string, record: any) => {
            return <Typography className="self-center">{`${value}(${record.prime_impact_count})` || '-'}</Typography>
        }
    },

    {
        title: 'Scan Type',
        dataIndex: "tools",
        key: "aggregated_tools",
        // width: '150px',
        render: (value: string[], record: any) => {
            return value.map((tool: string, index: number) =>
                <Tooltip key={index} title={formatType(record?.integration_id)} placement="right">
                    <Tag className="rounded-md bg-white border border-gray-300 text-sm">
                        <div className="flex gap-1">
                            <Image src={`/${tool}.svg`} alt="chipIcon" width={10} height={10} />
                            <Typography>{tool.toUpperCase()}</Typography>
                        </div>
                    </Tag>
                </Tooltip>
            )
        },
    },
    {
        title: 'Severity',
        dataIndex: "prime_impact",
        key: "prime_impact",
        width: '150px',
        render: (value: string) => {
            const colorMap: Record<string, string> = {
                low: "#40BE60",
                medium: "#FFA200",
                high: "#FF4248",
                critical: "#C80008",
                unknown: "#88879E",
            };
            return (
                <Typography
                    className="text-sm"
                    style={{ color: colorMap[value.toLowerCase()] || "#000000" }}
                >
                    {value.charAt(0).toUpperCase() + value.slice(1).toLowerCase()}
                </Typography>
            );
        },
    }
];
